<!DOCTYPE html>
<html lang="en-NZ">

<head>
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<meta charset="utf-8" />

	<link rel="shortcut icon" href="/logo.svg" />
	<title>Downloads → {{ app.name }} → {{ meta.version }}</title>
	<meta name="description"
		content="A suite of tools and libraries related to Watchexec, which runs commands when files change. Download page for official binaries for {{ app.name }} {{ meta.version }}." />

	<link rel="stylesheet" href="/style.css" />
</head>

<body>
	<section>
		<h2>
			<a href="/"><img class="logo-icon" src="/logo:{{ app.slug }}.svg" alt="Home"></a>
			←
			<a href="/downloads/">Downloads</a>
			←
			<a href="/downloads/{{ app.slug }}/">{{ app.name }}</a>
			←
			<a href="/downloads/{{ app.slug }}/{{ meta.version }}/">{{ meta.version }}</a>
		</h2>

		{%- if meta.notes -%}
		<aside>
			<h3>Release notes</h3>

			{{ meta.notes | safe }}
		</aside>
		{%- endif -%}

		{%- set has_sums = 0 < meta.sums | length -%}

		<table class="downloads">
			<thead>
				<tr>
					<th>OS</th>
					<th>Arch</th>
					<th>Variant</th>
					<th>Download</th>
					{% if has_sums %}<th>BLAKE3 checksum</th>{% endif %}
				</tr>
			</thead>
			<tbody>
				{%- for os, dls1 in meta.downloads | group_by(attribute='cats.0') -%}
					{%- set len1 = dls1 | length -%}
					{%- for arch, dls2 in dls1 | group_by(attribute='cats.1') -%}
						{%- set first2 = loop.first -%}
						{%- set len2 = dls2 | length -%}
						{%- for variant, dls3 in dls2 | group_by(attribute='cats.2') -%}
							{%- set first3 = loop.first -%}
							{%- set len3 = dls3 | length -%}
							{% for dl in dls3 %}
							<tr>
								{% if first2 and first3 and loop.first %}<td rowspan="{{ len1 }}">{{ os }}</td>{% endif %}
								{% if first3 and loop.first %}<td rowspan="{{ len2 }}">{{ arch }}</td>{% endif %}
								{% if loop.first %}<td rowspan="{{ len3 }}">{{ variant }}</td>{% endif %}
								<td><a class="download" href="{{ dl.url }}">{{ dl.size / 1024 | round }} KB ({{ dl.format.short }})</a></td>
								{% if has_sums %}<td>
									{%- set sum = dl.sums | filter(attribute='algo', value='BLAKE3') | map(attribute='sum') | first -%}
									{%- if sum -%}
										<code class="checksum">{{ sum }}</code>
									{%- else -%}
										<em class="missing-checksum">missing checksum</em>
									{%- endif -%}
								</td>{% endif %}
							</tr>
							{% endfor %}
						{%- endfor -%}
					{%- endfor -%}
				{%- endfor -%}
			</tbody>
		</table>

		{%- if has_sums -%}
		<table class="signatures">
			{% for sum in meta.sums %}
			<tr>
				<th><a href="{{ sum.url }}">{{ sum.algo }} checksums</a></th>
				{% for sign in sum.signs %}
				<td>
					<a href="{{ sign.sign_url }}">{{ sign.name }}</a>
					(<a href="{{ sign.key_url }}">key</a>)
				</td>
				{% endfor %}
			</tr>
			{% endfor %}
		</table>
		{% endif %}

		<p><a href="https://github.com/{{ app.repo.owner }}/{{ app.repo.repo }}/releases/{{ tag }}" target="_blank">
			<em>View on GitHub</em>
		</a></p>

		<p class="generator">
			version released on <time datetime="{{ meta.published }}">{{ meta.published | date }}</time>
			| this page built on <time datetime="{{ meta.generated }}">{{ meta.generated | date(format='%Y-%m-%d at %H:%M UTC') }}</time>
			| generator v{{ genver }}
			| <a href="meta.json">json metadata</a>
		</p>
	</section>
</body>

</html>
